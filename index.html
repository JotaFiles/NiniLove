<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nini ‚ù§Ô∏è Jota - Nuestro Amor</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-pink: #ff6b9d;
            --secondary-pink: #ffc1cc;
            --accent-blue: #4ecdc4;
            --light-pink: #fff0f3;
            --dark-text: #2d3436;
            --medium-text: #636e72;
            --white: #ffffff;
            --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-4: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            --shadow-light: 0 4px 20px rgba(255, 107, 157, 0.15);
            --shadow-medium: 0 8px 30px rgba(255, 107, 157, 0.2);
            --shadow-heavy: 0 15px 40px rgba(255, 107, 157, 0.3);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #ffeef8 0%, #f0f8ff 50%, #fff0f8 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .floating-heart {
            position: absolute;
            animation: float-heart 15s linear infinite;
            opacity: 0;
        }

        @keyframes float-heart {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            5% { opacity: 0.6; }
            95% { opacity: 0.6; }
            100% { transform: translateY(-20vh) rotate(360deg); opacity: 0; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header-content {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 25px;
            box-shadow: var(--shadow-light);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.8rem;
            background: var(--gradient-2);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .connection-status {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            font-weight: 500;
            font-size: 0.9rem;
            background: rgba(0, 184, 148, 0.1);
            color: #00b894;
            border: 1px solid rgba(0, 184, 148, 0.2);
        }

        .connection-status.offline {
            background: rgba(255, 87, 87, 0.1);
            color: #d63031;
            border: 1px solid rgba(255, 87, 87, 0.2);
        }

        .card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-light);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-medium);
        }

        .clock-section {
            text-align: center;
        }

        .clock-display {
            background: var(--gradient-2);
            color: white;
            padding: 15px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-medium);
        }

        .clock {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .date {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .love-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }

        .stat-item {
            background: rgba(255, 107, 157, 0.1);
            padding: 12px;
            border-radius: 12px;
            text-align: center;
            border-left: 4px solid var(--primary-pink);
        }

        .stat-number {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-pink);
            display: block;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--medium-text);
            margin-top: 5px;
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            color: var(--primary-pink);
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
        }

        /* ===== ESTILOS DEL CALENDARIO ===== */
        .calendar-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: var(--shadow-light);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .calendar-nav-btn {
            background: var(--gradient-3);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
        }

        .calendar-nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .calendar-month-year {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-pink);
            min-width: 200px;
            text-align: center;
        }

        .calendar-turn-info {
            background: var(--gradient-4);
            color: var(--dark-text);
            padding: 8px 15px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .calendar-day-header {
            text-align: center;
            font-weight: 600;
            color: var(--medium-text);
            padding: 10px 5px;
            font-size: 0.9rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(255, 107, 157, 0.1);
        }

        .calendar-day:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-light);
        }

        .calendar-day.other-month {
            color: #ccc;
            background: rgba(255, 255, 255, 0.2);
        }

        .calendar-day.today {
            background: var(--gradient-2);
            color: white;
            font-weight: 700;
            box-shadow: var(--shadow-medium);
        }

        .calendar-day.has-phrase {
            background: var(--gradient-4);
            color: var(--dark-text);
            font-weight: 600;
        }

        .calendar-day.has-phrase::after {
            content: 'üíï';
            position: absolute;
            bottom: 2px;
            right: 2px;
            font-size: 0.7rem;
        }

        .calendar-day.nini-turn {
            border: 2px solid var(--primary-pink);
            background: linear-gradient(135deg, rgba(255, 107, 157, 0.1) 0%, rgba(255, 107, 157, 0.3) 100%);
        }

        .calendar-day.jota-turn {
            border: 2px solid var(--accent-blue);
            background: linear-gradient(135deg, rgba(78, 205, 196, 0.1) 0%, rgba(78, 205, 196, 0.3) 100%);
        }

        .phrase-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 10000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .phrase-modal.show {
            display: flex;
        }

        .phrase-modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: var(--shadow-heavy);
            transform: scale(0.9);
            transition: all 0.3s ease;
        }

        .phrase-modal.show .phrase-modal-content {
            transform: scale(1);
        }

        .phrase-modal-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .phrase-modal-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            color: var(--primary-pink);
            margin-bottom: 10px;
        }

        .phrase-modal-date {
            color: var(--medium-text);
            font-size: 0.9rem;
        }

        .phrase-modal-turn {
            background: var(--gradient-4);
            padding: 10px 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .phrase-form {
            margin-bottom: 20px;
        }

        .phrase-display {
            background: rgba(255, 107, 157, 0.1);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid var(--primary-pink);
            margin-bottom: 15px;
        }

        .phrase-text {
            font-style: italic;
            color: var(--dark-text);
            margin-bottom: 8px;
        }

        .phrase-author {
            font-size: 0.85rem;
            color: var(--medium-text);
            text-align: right;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 12px;
            background: rgba(255, 107, 157, 0.05);
            border: 2px solid rgba(255, 107, 157, 0.1);
            font-family: 'Poppins', sans-serif;
            font-size: 0.95rem;
            color: var(--dark-text);
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-pink);
            background: rgba(255, 107, 157, 0.1);
            box-shadow: var(--shadow-light);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .file-upload input[type="file"] {
            display: none;
        }

        .file-upload-btn {
            display: block;
            width: 100%;
            padding: 12px;
            background: var(--gradient-3);
            color: white;
            text-align: center;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            box-shadow: var(--shadow-light);
        }

        .file-upload-btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-medium);
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 20px;
            background: var(--gradient-2);
            color: white;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-light);
            font-size: 0.9rem;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--gradient-3);
        }

        .btn-close {
            background: #95a5a6;
            width: auto;
            padding: 8px 15px;
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .modal-actions .btn {
            flex: 1;
            min-width: 120px;
        }

        .content-grid {
            display: grid;
            gap: 15px;
        }

        .content-item {
            background: rgba(255, 255, 255, 0.7);
            padding: 15px;
            border-radius: 15px;
            border-left: 4px solid var(--primary-pink);
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
        }

        .content-item:hover {
            transform: translateX(3px);
            box-shadow: var(--shadow-medium);
        }

        .content-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .content-author {
            font-weight: 600;
            color: var(--primary-pink);
            font-size: 0.9rem;
        }

        .content-time {
            font-size: 0.75rem;
            color: var(--medium-text);
            background: rgba(255, 107, 157, 0.1);
            padding: 4px 8px;
            border-radius: 8px;
        }

        .content-text {
            color: var(--dark-text);
            line-height: 1.5;
            font-style: italic;
            font-size: 0.9rem;
        }

        .memory-image {
            width: 100%;
            max-height: 250px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 12px;
            box-shadow: var(--shadow-light);
        }

        .loading {
            text-align: center;
            color: var(--primary-pink);
            font-style: italic;
            padding: 30px 15px;
        }

        .error {
            background: rgba(255, 87, 87, 0.1);
            color: #d63031;
            padding: 12px;
            border-radius: 12px;
            border-left: 4px solid #d63031;
            margin-bottom: 15px;
        }

        .success {
            background: rgba(0, 184, 148, 0.1);
            color: #00b894;
            padding: 12px;
            border-radius: 12px;
            border-left: 4px solid #00b894;
            margin-bottom: 15px;
        }

        .empty-state {
            text-align: center;
            color: var(--medium-text);
            font-style: italic;
            padding: 30px 15px;
            background: rgba(255, 107, 157, 0.05);
            border-radius: 15px;
            border: 2px dashed rgba(255, 107, 157, 0.2);
        }

        @media (max-width: 768px) {
            .container { padding: 10px; }
            .header h1 { font-size: 2.2rem; }
            .card { padding: 15px; }
            .clock { font-size: 1.8rem; }
            .love-stats { grid-template-columns: repeat(3, 1fr); gap: 8px; }
            
            .calendar-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .calendar-nav {
                order: 2;
            }
            
            .calendar-turn-info {
                order: 1;
                text-align: center;
            }
            
            .calendar-month-year {
                order: 3;
            }
            
            .calendar-grid {
                gap: 4px;
            }
            
            .calendar-day {
                font-size: 0.85rem;
            }
            
            .phrase-modal-content {
                padding: 20px;
                margin: 10px;
            }
            
            .modal-actions {
                flex-direction: column;
            }
            
            .modal-actions .btn {
                width: 100%;
            }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeInUp 0.6s ease forwards;
        }
    </style>
</head>
<body>
    <div class="animated-bg" id="animatedBg"></div>
    
    <div class="container">
        <header class="header fade-in">
            <div class="header-content">
                <div id="connectionStatus" class="connection-status">
                    üîÑ Configurando conexi√≥n...
                </div>
                <img src="https://i.gifer.com/origin/36/36bcb36e9832e37c993063a41da0fbc4_w200.gif" alt="Descripci√≥n" style="display:block;margin:0 auto;width:150px;height:auto;border-radius:12px;">

                <h1>Nini ‚ù§Ô∏è Jota</h1>
                <p>Nuestro espacio de amor uwu</p>
            </div>
        </header>

        <!-- Secci√≥n del reloj -->
        <div class="card fade-in">
            <div class="clock-section">
                <div class="clock-display">
                    <div class="clock" id="clock">00:00:00</div>
                    <div class="date" id="date">Cargando fecha...</div>
                </div>
                
                <div class="love-stats">
                    <div class="stat-item">
                        <span class="stat-number" id="daysTogether">0</span>
                        <span class="stat-label">D√≠as juntos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalMemories">0</span>
                        <span class="stat-label">Recuerdos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalMessages">0</span>
                        <span class="stat-label">Mensajes</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalPhrases">0</span>
                        <span class="stat-label">Frases del d√≠a</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Secci√≥n del calendario -->
        <div class="card fade-in">
            <h2 class="section-title">üìÖ Calendario de Frases del D√≠a</h2>
            
            <div class="calendar-container">
                <div class="calendar-header">
                    <div class="calendar-nav">
                        <button class="calendar-nav-btn" onclick="LoveApp.changeMonth(-1)">‚Äπ</button>
                        <div class="calendar-month-year" id="calendarMonthYear">Enero 2024</div>
                        <button class="calendar-nav-btn" onclick="LoveApp.changeMonth(1)">‚Ä∫</button>
                    </div>
                    <div class="calendar-turn-info" id="calendarTurnInfo">
                        üåü Hoy le toca a: Cargando...
                    </div>
                </div>
                
                <div class="calendar-grid" id="calendarGrid">
                    <div class="calendar-day-header">Dom</div>
                    <div class="calendar-day-header">Lun</div>
                    <div class="calendar-day-header">Mar</div>
                    <div class="calendar-day-header">Mi√©</div>
                    <div class="calendar-day-header">Jue</div>
                    <div class="calendar-day-header">Vie</div>
                    <div class="calendar-day-header">S√°b</div>
                </div>
            </div>
        </div>

        <!-- Secci√≥n de mensajes de amor -->
        <div class="card fade-in">
            <h2 class="section-title">üíå Mensajes de Amor</h2>
            
            <div class="form-group">
                <select class="form-select" id="messageAuthor">
                    <option value="Nini">üíñ Nini</option>
                    <option value="Jota">üíô Jota</option>
                </select>
            </div>
            
            <div class="form-group">
                <textarea class="form-textarea" id="messageText" 
                         placeholder="Escribe un mensaje bonito para tu amor..." maxlength="500"></textarea>
            </div>
            
            <button class="btn" onclick="LoveApp.addMessage()" id="addMessageBtn">
                ‚ú® Enviar Mensaje
            </button>
            
            <div class="content-grid" id="messagesList" style="margin-top: 25px;">
                <div class="loading">Cargando mensajes de amor... üíï</div>
            </div>
        </div>

        <!-- Secci√≥n de recuerdos -->
        <div class="card fade-in">
            <h2 class="section-title">üì∏ Galer√≠a de Recuerdos</h2>
            
            <div class="form-group">
                <select class="form-select" id="memoryAuthor">
                    <option value="Nini">üíñ Nini</option>
                    <option value="Jota">üíô Jota</option>
                </select>
            </div>
            
            <div class="form-group">
                <input type="text" class="form-input" id="memoryTitle" 
                       placeholder="T√≠tulo del recuerdo..." maxlength="100">
            </div>
            
            <div class="form-group">
                <div class="file-upload">
                    <input type="file" id="memoryImage" accept="image/*">
                    <label for="memoryImage" class="file-upload-btn">
                        üì∑ Subir Imagen
                    </label>
                </div>
            </div>
            
            <button class="btn" onclick="LoveApp.addMemory()" id="addMemoryBtn">
                ‚ú® Guardar Recuerdo
            </button>
            
            <div class="content-grid" id="memoriesGrid" style="margin-top: 25px;">
                <div class="loading">Cargando recuerdos... üíï</div>
            </div>
        </div>
    </div>

    <!-- Modal para frases del d√≠a -->
    <div class="phrase-modal" id="phraseModal">
        <div class="phrase-modal-content">
            <div class="phrase-modal-header">
                <div class="phrase-modal-title" id="phraseModalTitle">Frase del D√≠a</div>
                <div class="phrase-modal-date" id="phraseModalDate">Fecha</div>
            </div>
            
            <div class="phrase-modal-turn" id="phraseModalTurn">
                Es el turno de: Cargando...
            </div>
            
            <div id="phraseDisplay" style="display: none;"></div>
            
            <div id="phraseForm" class="phrase-form">
                <div class="form-group">
                    <textarea class="form-textarea" id="phraseText" 
                             placeholder="Escribe una frase bonita para este d√≠a..." maxlength="300"></textarea>
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="btn" onclick="LoveApp.saveDailyPhrase()" id="savePhraseBtn">
                    ‚ú® Guardar Frase
                </button>
                <button class="btn btn-close" onclick="LoveApp.closePhraseModal()">
                    Cerrar
                </button>
            </div>
        </div>
    </div>

    <!-- Incluir Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        // ===== APLICACI√ìN PRINCIPAL =====
        const LoveApp = {
            // Configuraci√≥n de Supabase
            supabase: null,
            isConnected: false,
            
            // Datos
            messages: [],
            memories: [],
            dailyPhrases: [],
            
            // Fecha de inicio de la relaci√≥n
            relationshipStart: new Date('2024-10-20'),
            
            // Estado del calendario
            currentDate: new Date(),
            selectedDate: null,
            
            // ===== FUNCIONES DE FECHA CON ZONA HORARIA DE CHILE =====
            getChileDate() {
                // Crear fecha en zona horaria de Chile (UTC-3 o UTC-4 dependiendo del horario de verano)
                const now = new Date();
                const chileOffset = -3; // Chile est√° en UTC-3 la mayor parte del a√±o
                const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
                const chileTime = new Date(utc + (chileOffset * 3600000));
                return chileTime;
            },
            
            formatDateChile(date) {
                // Asegurar que usamos la zona horaria de Chile
                return new Date(date.getTime() - (date.getTimezoneOffset() * 60000))
                    .toISOString().split('T')[0];
            },
            
            isSameDay(date1, date2) {
                // Comparar fechas usando zona horaria de Chile
                return this.formatDateChile(date1) === this.formatDateChile(date2);
            },
            
            // ===== INICIALIZACI√ìN =====
            async init() {
                console.log('üöÄ Iniciando aplicaci√≥n de amor...');
                console.log('üá®üá± Configurado para zona horaria de Chile (Calama)');
                
                // Mostrar instrucciones de configuraci√≥n
                this.showSetupInstructions();
                
                // Crear fondo animado
                this.createAnimatedBackground();
                
                // Inicializar reloj
                this.updateClock();
                setInterval(() => this.updateClock(), 1000);
                
                // Inicializar efectos
                setInterval(() => this.createFloatingHeart(), 5000);
                
                // Intentar conectar a Supabase
                await this.initializeSupabase();
                
                // Inicializar calendario
                this.renderCalendar();
                
                // Agregar animaciones de entrada
                this.addEntryAnimations();
                
                console.log('‚úÖ Aplicaci√≥n inicializada');
            },
            
            // ===== CONFIGURACI√ìN DE SUPABASE =====
            async initializeSupabase() {
                // INSTRUCCIONES: Reemplaza estas variables con los valores de tu proyecto Supabase
                const SUPABASE_URL = 'https://qumdmfeamvtrevcjfjvl.supabase.co';
                const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF1bWRtZmVhbXZ0cmV2Y2pmanZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQzMjY4MDYsImV4cCI6MjA2OTkwMjgwNn0.I8RxHA63ZmTukDeV3h2F8pv0Z8JZ7B7sHOubI0hUOKk';
                
                // Verificar si las variables est√°n configuradas
                if (SUPABASE_URL.includes('tu-proyecto') || SUPABASE_ANON_KEY.includes('tu-anon-key')) {
                    this.updateConnectionStatus('‚ö†Ô∏è Necesitas configurar las credenciales de Supabase', false);
                    return;
                }
                
                try {
                    this.updateConnectionStatus('üîÑ Conectando a Supabase...', false);
                    
                    // Inicializar cliente
                    this.supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                    
                    // Verificar conexi√≥n
                    const { data, error } = await this.supabase
                        .from('love_messages')
                        .select('count', { count: 'exact', head: true });
                    
                    if (error) {
                        console.error('Error verificando conexi√≥n:', error);
                        throw new Error('Error de conexi√≥n. Verifica las credenciales.');
                    }
                    
                    this.isConnected = true;
                    this.updateConnectionStatus('‚úÖ Conectado - Sincronizaci√≥n en tiempo real activada', true);
                    
                    // Cargar datos iniciales
                    await this.loadAllData();
                    
                    // Configurar actualizaciones en tiempo real
                    this.setupRealtimeSubscriptions();
                    
                    console.log('‚úÖ Supabase conectado correctamente');
                    
                } catch (error) {
                    console.error('‚ùå Error conectando a Supabase:', error);
                    this.updateConnectionStatus('‚ùå Error de conexi√≥n - Revisa la configuraci√≥n', false);
                    this.showMessage('‚ùå Error conectando a Supabase. Revisa la configuraci√≥n.', 'error');
                }
            },
            
            // ===== SUSCRIPCIONES EN TIEMPO REAL =====
            setupRealtimeSubscriptions() {
                // Suscribirse a mensajes
                this.supabase
                    .channel('love_messages_channel')
                    .on('postgres_changes', 
                        { event: '*', schema: 'public', table: 'love_messages' }, 
                        (payload) => {
                            console.log('üîÑ Cambio en mensajes:', payload);
                            this.loadMessages();
                        }
                    )
                    .subscribe();

                // Suscribirse a recuerdos
                this.supabase
                    .channel('love_memories_channel')
                    .on('postgres_changes', 
                        { event: '*', schema: 'public', table: 'love_memories' }, 
                        (payload) => {
                            console.log('üîÑ Cambio en recuerdos:', payload);
                            this.loadMemories();
                        }
                    )
                    .subscribe();

                // Suscribirse a frases diarias
                this.supabase
                    .channel('daily_phrases_channel')
                    .on('postgres_changes', 
                        { event: '*', schema: 'public', table: 'daily_phrases' }, 
                        (payload) => {
                            console.log('üîÑ Cambio en frases diarias:', payload);
                            this.loadDailyPhrases();
                        }
                    )
                    .subscribe();

                console.log('üî¥ Suscripciones en tiempo real configuradas');
            },
            
            // ===== CARGA DE DATOS =====
            async loadAllData() {
                await Promise.all([
                    this.loadMessages(),
                    this.loadMemories(),
                    this.loadDailyPhrases()
                ]);
                this.updateStats();
                this.renderCalendar();
            },
            
            async loadMessages() {
                const container = document.getElementById('messagesList');
                
                if (!this.isConnected) {
                    container.innerHTML = '<div class="error">Sin conexi√≥n a la base de datos</div>';
                    return;
                }
                
                container.innerHTML = '<div class="loading">Cargando mensajes de amor... üíï</div>';
                
                try {
                    const { data, error } = await this.supabase
                        .from('love_messages')
                        .select('*')
                        .order('created_at', { ascending: false });
                    
                    if (error) throw error;
                    
                    this.messages = data || [];
                    this.displayMessages();
                    
                    console.log('‚úÖ Mensajes cargados:', this.messages.length);
                    
                } catch (error) {
                    console.error('‚ùå Error cargando mensajes:', error);
                    container.innerHTML = '<div class="error">Error cargando mensajes</div>';
                }
            },
            
            async loadMemories() {
                const container = document.getElementById('memoriesGrid');
                
                if (!this.isConnected) {
                    container.innerHTML = '<div class="error">Sin conexi√≥n a la base de datos</div>';
                    return;
                }
                
                container.innerHTML = '<div class="loading">Cargando recuerdos... üíï</div>';
                
                try {
                    const { data, error } = await this.supabase
                        .from('love_memories')
                        .select('*')
                        .order('created_at', { ascending: false });
                    
                    if (error) throw error;
                    
                    this.memories = data || [];
                    this.displayMemories();
                    
                    console.log('‚úÖ Recuerdos cargados:', this.memories.length);
                    
                } catch (error) {
                    console.error('‚ùå Error cargando recuerdos:', error);
                    container.innerHTML = '<div class="error">Error cargando recuerdos</div>';
                }
            },
            
            async loadDailyPhrases() {
                if (!this.isConnected) return;
                
                try {
                    const { data, error } = await this.supabase
                        .from('daily_phrases')
                        .select('*')
                        .order('date', { ascending: false });
                    
                    if (error) throw error;
                    
                    this.dailyPhrases = data || [];
                    console.log('‚úÖ Frases diarias cargadas:', this.dailyPhrases.length);
                    
                } catch (error) {
                    console.error('‚ùå Error cargando frases diarias:', error);
                }
            },
            
            // ===== FUNCIONES DEL CALENDARIO =====
            renderCalendar() {
                const grid = document.getElementById('calendarGrid');
                if (!grid) return;
                
                // Limpiar grid manteniendo headers
                const headers = grid.querySelectorAll('.calendar-day-header');
                grid.innerHTML = '';
                headers.forEach(header => grid.appendChild(header));
                
                const year = this.currentDate.getFullYear();
                const month = this.currentDate.getMonth();
                
                // Actualizar t√≠tulo del mes
                const monthNames = [
                    'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                    'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'
                ];
                document.getElementById('calendarMonthYear').textContent = `${monthNames[month]} ${year}`;
                
                // Actualizar info de turno para hoy
                this.updateTurnInfo();
                
                // Primer d√≠a del mes y cu√°ntos d√≠as tiene
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const daysInMonth = lastDay.getDate();
                const startingDayOfWeek = firstDay.getDay();
                
                // D√≠as del mes anterior
                const prevMonth = new Date(year, month - 1);
                const daysInPrevMonth = new Date(year, month, 0).getDate();
                
                for (let i = startingDayOfWeek - 1; i >= 0; i--) {
                    const day = daysInPrevMonth - i;
                    const dayElement = this.createDayElement(day, true, new Date(prevMonth.getFullYear(), prevMonth.getMonth(), day));
                    grid.appendChild(dayElement);
                }
                
                // D√≠as del mes actual
                for (let day = 1; day <= daysInMonth; day++) {
                    const date = new Date(year, month, day);
                    const dayElement = this.createDayElement(day, false, date);
                    grid.appendChild(dayElement);
                }
                
                // D√≠as del mes siguiente para completar la grid
                const totalCells = grid.children.length - 7; // Restar headers
                const remainingCells = 42 - totalCells; // 6 filas √ó 7 d√≠as
                
                for (let day = 1; day <= remainingCells; day++) {
                    const nextMonth = new Date(year, month + 1);
                    const dayElement = this.createDayElement(day, true, new Date(nextMonth.getFullYear(), nextMonth.getMonth(), day));
                    grid.appendChild(dayElement);
                }
            },
            
            createDayElement(day, isOtherMonth, date) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;
                dayElement.dataset.date = this.formatDateChile(date);
                
                if (isOtherMonth) {
                    dayElement.classList.add('other-month');
                }
                
                // Marcar d√≠a de hoy usando fecha de Chile
                const today = this.getChileDate();
                if (this.isSameDay(date, today)) {
                    dayElement.classList.add('today');
                }
                
                // Verificar si tiene frase
                const dateString = this.formatDateChile(date);
                const hasPhrase = this.dailyPhrases.some(phrase => phrase.date === dateString);
                if (hasPhrase) {
                    dayElement.classList.add('has-phrase');
                }
                
                // Determinar de qui√©n es el turno
                const turn = this.getTurnForDate(date);
                if (turn === 'Nini') {
                    dayElement.classList.add('nini-turn');
                } else if (turn === 'Jota') {
                    dayElement.classList.add('jota-turn');
                }
                
                // Agregar evento click
                dayElement.addEventListener('click', () => {
                    if (!isOtherMonth) {
                        this.openPhraseModal(date);
                    }
                });
                
                return dayElement;
            },
            
            getTurnForDate(date) {
                // Calcular d√≠as desde el inicio de la relaci√≥n usando zona horaria de Chile
                const daysSinceStart = Math.floor((date - this.relationshipStart) / (1000 * 60 * 60 * 24));
                
                // Alternar turnos cada d√≠a (empezando con Nini)
                return daysSinceStart % 2 === 0 ? 'Nini' : 'Jota';
            },
            
            updateTurnInfo() {
                const today = this.getChileDate();
                const todayTurn = this.getTurnForDate(today);
                const turnInfo = document.getElementById('calendarTurnInfo');
                
                if (turnInfo) {
                    const emoji = todayTurn === 'Nini' ? 'üíñ' : 'üíô';
                    turnInfo.innerHTML = `üåü Hoy le toca a: ${emoji} ${todayTurn}`;
                }
            },
            
            changeMonth(direction) {
                this.currentDate.setMonth(this.currentDate.getMonth() + direction);
                this.renderCalendar();
            },
            
            // ===== MODAL DE FRASES DIARIAS =====
            openPhraseModal(date) {
                this.selectedDate = date;
                const dateString = this.formatDateChile(date);
                const turn = this.getTurnForDate(date);
                
                // Actualizar contenido del modal
                document.getElementById('phraseModalTitle').textContent = 'Frase del D√≠a';
                document.getElementById('phraseModalDate').textContent = date.toLocaleDateString('es-CL', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                const emoji = turn === 'Nini' ? 'üíñ' : 'üíô';
                document.getElementById('phraseModalTurn').innerHTML = `Es el turno de: ${emoji} ${turn}`;
                
                // Verificar si ya existe una frase
                const existingPhrase = this.dailyPhrases.find(phrase => phrase.date === dateString);
                
                if (existingPhrase) {
                    // Mostrar frase existente
                    this.showExistingPhrase(existingPhrase);
                } else {
                    // Mostrar formulario para nueva frase
                    this.showPhraseForm(turn, date);
                }
                
                // Mostrar modal
                document.getElementById('phraseModal').classList.add('show');
            },
            
            showExistingPhrase(phrase) {
                document.getElementById('phraseForm').style.display = 'none';
                document.getElementById('savePhraseBtn').style.display = 'none';
                
                const display = document.getElementById('phraseDisplay');
                display.innerHTML = `
                    <div class="phrase-display">
                        <div class="phrase-text">"${phrase.phrase}"</div>
                        <div class="phrase-author">‚Äî ${phrase.author}</div>
                    </div>
                `;
                display.style.display = 'block';
            },
            
            showPhraseForm(turn, selectedDate) {
                const today = this.getChileDate();
                const isToday = this.isSameDay(selectedDate, today);
                const isPast = selectedDate < today && !this.isSameDay(selectedDate, today);
                const isFuture = selectedDate > today && !this.isSameDay(selectedDate, today);
                
                console.log('üìÖ Verificando fecha:', {
                    selectedDate: this.formatDateChile(selectedDate),
                    today: this.formatDateChile(today),
                    isToday,
                    isPast,
                    isFuture
                });
                
                document.getElementById('phraseDisplay').style.display = 'none';
                
                if (isPast) {
                    // No permitir agregar frases a d√≠as pasados
                    document.getElementById('phraseForm').innerHTML = `
                        <div class="error">
                            No se pueden agregar frases a d√≠as pasados.
                        </div>
                    `;
                    document.getElementById('savePhraseBtn').style.display = 'none';
                } else if (isToday) {
                    // Permitir agregar la frase del d√≠a actual
                    document.getElementById('phraseForm').style.display = 'block';
                    document.getElementById('savePhraseBtn').style.display = 'block';
                    document.getElementById('phraseText').value = '';
                    
                    // Mensaje informativo sobre el turno
                    const phraseForm = document.getElementById('phraseForm');
                    const infoDiv = phraseForm.querySelector('.turn-info');
                    if (infoDiv) infoDiv.remove();
                    
                    const turnInfoDiv = document.createElement('div');
                    turnInfoDiv.className = 'turn-info';
                    turnInfoDiv.style.cssText = 'background: rgba(255, 107, 157, 0.1); padding: 10px; border-radius: 8px; margin-bottom: 15px; text-align: center; font-size: 0.9rem; color: var(--dark-text);';
                    turnInfoDiv.innerHTML = `‚ú® Hoy es tu turno, ${turn}! Escribe una frase bonita para este d√≠a.`;
                    
                    phraseForm.insertBefore(turnInfoDiv, phraseForm.firstChild);
                } else if (isFuture) {
                    // D√≠a futuro
                    document.getElementById('phraseForm').innerHTML = `
                        <div style="background: rgba(78, 205, 196, 0.1); padding: 15px; border-radius: 12px; text-align: center; color: var(--dark-text);">
                            üîÆ Este d√≠a a√∫n no ha llegado.<br>
                            Cuando sea ${selectedDate.toLocaleDateString('es-CL')}, ${turn} podr√° escribir la frase del d√≠a.
                        </div>
                    `;
                    document.getElementById('savePhraseBtn').style.display = 'none';
                }
            },
            
            async saveDailyPhrase() {
                if (!this.isConnected) {
                    this.showMessage('‚ùå Sin conexi√≥n a la base de datos', 'error');
                    return;
                }
                
                const phraseText = document.getElementById('phraseText').value.trim();
                const turn = this.getTurnForDate(this.selectedDate);
                const dateString = this.formatDateChile(this.selectedDate);
                const button = document.getElementById('savePhraseBtn');
                
                if (!phraseText) {
                    this.showMessage('Por favor, escribe una frase bonita üíï', 'error');
                    return;
                }
                
                button.disabled = true;
                button.textContent = '‚è≥ Guardando...';
                
                try {
                    const { error } = await this.supabase
                        .from('daily_phrases')
                        .insert([{
                            date: dateString,
                            author: turn,
                            phrase: phraseText
                        }]);
                    
                    if (error) throw error;
                    
                    this.showMessage('‚ú® Frase guardada con amor', 'success');
                    this.closePhraseModal();
                    
                } catch (error) {
                    console.error('‚ùå Error guardando frase:', error);
                    this.showMessage('‚ùå Error guardando frase', 'error');
                } finally {
                    button.disabled = false;
                    button.textContent = '‚ú® Guardar Frase';
                }
            },
            
            closePhraseModal() {
                document.getElementById('phraseModal').classList.remove('show');
                this.selectedDate = null;
            },
            
            // ===== AGREGAR CONTENIDO =====
            async addMessage() {
                if (!this.isConnected) {
                    this.showMessage('‚ùå Sin conexi√≥n a la base de datos', 'error');
                    return;
                }
                
                const text = document.getElementById('messageText').value.trim();
                const author = document.getElementById('messageAuthor').value;
                const button = document.getElementById('addMessageBtn');
                
                if (!text) {
                    this.showMessage('Por favor, escribe un mensaje bonito üíï', 'error');
                    return;
                }
                
                button.disabled = true;
                button.textContent = '‚è≥ Enviando...';
                
                try {
                    const { error } = await this.supabase
                        .from('love_messages')
                        .insert([{
                            author: author,
                            message: text
                        }]);
                    
                    if (error) throw error;
                    
                    // Limpiar formulario
                    document.getElementById('messageText').value = '';
                    
                    this.showMessage('‚ú® Mensaje enviado con amor', 'success');
                    
                } catch (error) {
                    console.error('‚ùå Error guardando mensaje:', error);
                    this.showMessage('‚ùå Error enviando mensaje', 'error');
                } finally {
                    button.disabled = false;
                    button.textContent = '‚ú® Enviar Mensaje';
                }
            },
            
            async addMemory() {
                if (!this.isConnected) {
                    this.showMessage('‚ùå Sin conexi√≥n a la base de datos', 'error');
                    return;
                }
                
                const title = document.getElementById('memoryTitle').value.trim();
                const author = document.getElementById('memoryAuthor').value;
                const imageFile = document.getElementById('memoryImage').files[0];
                const button = document.getElementById('addMemoryBtn');
                
                if (!title) {
                    this.showMessage('Por favor, escribe un t√≠tulo para el recuerdo üíï', 'error');
                    return;
                }
                
                if (!imageFile) {
                    this.showMessage('Por favor, selecciona una imagen üì∏', 'error');
                    return;
                }
                
                button.disabled = true;
                button.textContent = '‚è≥ Guardando...';
                
                try {
                    let imageUrl = null;
                    
                    // Subir imagen
                    const fileName = `${Date.now()}_${imageFile.name}`;
                    const { data: uploadData, error: uploadError } = await this.supabase.storage
                        .from('love-memories')
                        .upload(fileName, imageFile);
                    
                    if (uploadError) throw uploadError;
                    
                    // Obtener URL p√∫blica
                    const { data: urlData } = this.supabase.storage
                        .from('love-memories')
                        .getPublicUrl(fileName);
                    
                    imageUrl = urlData.publicUrl;
                    
                    // Guardar en base de datos
                    const { error } = await this.supabase
                        .from('love_memories')
                        .insert([{
                            author: author,
                            title: title,
                            image_url: imageUrl
                        }]);
                    
                    if (error) throw error;
                    
                    // Limpiar formulario
                    document.getElementById('memoryTitle').value = '';
                    document.getElementById('memoryImage').value = '';
                    
                    this.showMessage('üì∏ Recuerdo guardado con amor', 'success');
                    
                } catch (error) {
                    console.error('‚ùå Error guardando recuerdo:', error);
                    this.showMessage('‚ùå Error guardando recuerdo', 'error');
                } finally {
                    button.disabled = false;
                    button.textContent = '‚ú® Guardar Recuerdo';
                }
            },
            
            // ===== MOSTRAR CONTENIDO =====
            displayMessages() {
                const container = document.getElementById('messagesList');
                
                if (this.messages.length === 0) {
                    container.innerHTML = '<div class="empty-state">A√∫n no hay mensajes de amor. ¬°S√© el primero en escribir uno! üíï</div>';
                    return;
                }
                
                container.innerHTML = this.messages.map(message => `
                    <div class="content-item">
                        <div class="content-meta">
                            <span class="content-author">${message.author}</span>
                            <span class="content-time">${this.formatDate(message.created_at)}</span>
                        </div>
                        <div class="content-text">"${message.message}"</div>
                    </div>
                `).join('');
            },
            
            displayMemories() {
                const container = document.getElementById('memoriesGrid');
                
                if (this.memories.length === 0) {
                    container.innerHTML = '<div class="empty-state">A√∫n no hay recuerdos. ¬°Sube tu primera foto! üì∏</div>';
                    return;
                }
                
                container.innerHTML = this.memories.map(memory => `
                    <div class="content-item">
                        ${memory.image_url ? `<img src="${memory.image_url}" class="memory-image" alt="${memory.title}">` : ''}
                        <div class="content-meta">
                            <span class="content-author">${memory.author}</span>
                            <span class="content-time">${this.formatDate(memory.created_at)}</span>
                        </div>
                        <div class="content-text"><strong>${memory.title}</strong></div>
                    </div>
                `).join('');
            },
            
            // ===== UTILIDADES =====
            updateConnectionStatus(message, connected) {
                const statusElement = document.getElementById('connectionStatus');
                statusElement.textContent = message;
                statusElement.className = connected ? 'connection-status' : 'connection-status offline';
            },
            
            updateClock() {
                // Usar hora de Chile
                const now = this.getChileDate();
                const timeString = now.toLocaleTimeString('es-CL', {
                    hour12: false,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                
                const dateString = now.toLocaleDateString('es-CL', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                document.getElementById('clock').textContent = timeString;
                document.getElementById('date').textContent = dateString;
            },
            
            updateStats() {
                const today = this.getChileDate();
                const daysTogether = Math.floor((today - this.relationshipStart) / (1000 * 60 * 60 * 24));
                document.getElementById('daysTogether').textContent = daysTogether;
                document.getElementById('totalMemories').textContent = this.memories.length;
                document.getElementById('totalMessages').textContent = this.messages.length;
                document.getElementById('totalPhrases').textContent = this.dailyPhrases.length;
            },
            
            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('es-CL', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            },
            
            showMessage(message, type) {
                const messageDiv = document.createElement('div');
                messageDiv.className = type;
                messageDiv.textContent = message;
                messageDiv.style.position = 'fixed';
                messageDiv.style.top = '20px';
                messageDiv.style.right = '20px';
                messageDiv.style.zIndex = '10000';
                messageDiv.style.padding = '15px 20px';
                messageDiv.style.borderRadius = '15px';
                messageDiv.style.fontWeight = '500';
                messageDiv.style.maxWidth = '300px';
                messageDiv.style.wordWrap = 'break-word';
                
                document.body.appendChild(messageDiv);
                
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.remove();
                    }
                }, 4000);
            },
            
            // ===== EFECTOS VISUALES =====
            createAnimatedBackground() {
                const bg = document.getElementById('animatedBg');
                
                // Crear formas geom√©tricas flotantes
                for (let i = 0; i < 6; i++) {
                    const shape = document.createElement('div');
                    shape.style.position = 'absolute';
                    shape.style.width = Math.random() * 80 + 40 + 'px';
                    shape.style.height = shape.style.width;
                    shape.style.borderRadius = '50%';
                    shape.style.background = `linear-gradient(45deg, rgba(255, 107, 157, 0.1), rgba(78, 205, 196, 0.1))`;
                    shape.style.left = Math.random() * 100 + '%';
                    shape.style.top = Math.random() * 100 + '%';
                    shape.style.animation = `float-shape ${Math.random() * 20 + 15}s ease-in-out infinite`;
                    shape.style.animationDelay = Math.random() * 10 + 's';
                    bg.appendChild(shape);
                }
                
                // Agregar animaci√≥n CSS para las formas
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes float-shape {
                        0%, 100% { transform: translateY(0px) translateX(0px) scale(1); opacity: 0.3; }
                        25% { transform: translateY(-30px) translateX(20px) scale(1.1); opacity: 0.5; }
                        50% { transform: translateY(-60px) translateX(-10px) scale(0.9); opacity: 0.4; }
                        75% { transform: translateY(-30px) translateX(-20px) scale(1.2); opacity: 0.6; }
                    }
                `;
                document.head.appendChild(style);
            },
            
            createFloatingHeart() {
                const heart = document.createElement('div');
                heart.className = 'floating-heart';
                heart.innerHTML = ['üíï', 'üíñ', 'üíó', 'üíù', 'üíò'][Math.floor(Math.random() * 5)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.fontSize = Math.random() * 20 + 15 + 'px';
                heart.style.animationDuration = (Math.random() * 10 + 10) + 's';
                
                document.getElementById('animatedBg').appendChild(heart);
                
                setTimeout(() => {
                    if (heart.parentNode) {
                        heart.remove();
                    }
                }, 15000);
            },
            
            addEntryAnimations() {
                const cards = document.querySelectorAll('.card');
                cards.forEach((card, index) => {
                    setTimeout(() => {
                        card.classList.add('fade-in');
                    }, index * 200);
                });
            },
            
            // ===== INSTRUCCIONES DE CONFIGURACI√ìN =====
            showSetupInstructions() {
                console.log(`
üöÄ CONFIGURACI√ìN DE SUPABASE PARA NINI & JOTA CON CALENDARIO

üìã PASOS PARA CONFIGURAR:

1Ô∏è‚É£ Crear proyecto en Supabase:
   - Ve a https://supabase.com
   - Crea un nuevo proyecto
   - Anota el Project URL y anon key

2Ô∏è‚É£ Configurar credenciales:
   - En el c√≥digo JavaScript, reemplaza:
     SUPABASE_URL = 'https://tu-proyecto.supabase.co'
     SUPABASE_ANON_KEY = 'tu-anon-key-aqui'

3Ô∏è‚É£ Crear las tablas (ejecuta en SQL Editor):

-- Tabla para mensajes de amor
CREATE TABLE love_messages (
    id BIGSERIAL PRIMARY KEY,
    author TEXT NOT NULL,
    message TEXT NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Tabla para recuerdos con im√°genes
CREATE TABLE love_memories (
    id BIGSERIAL PRIMARY KEY,
    author TEXT NOT NULL,
    title TEXT NOT NULL,
    image_url TEXT,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Tabla para frases diarias del calendario
CREATE TABLE daily_phrases (
    id BIGSERIAL PRIMARY KEY,
    date DATE NOT NULL UNIQUE,
    author TEXT NOT NULL,
    phrase TEXT NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

4Ô∏è‚É£ Configurar storage para im√°genes:

-- Crear bucket para recuerdos
INSERT INTO storage.buckets (id, name, public) 
VALUES ('love-memories', 'love-memories', true);

-- Configurar pol√≠ticas de seguridad para storage
CREATE POLICY "Public Access" ON storage.objects FOR SELECT USING (bucket_id = 'love-memories');
CREATE POLICY "Authenticated users can upload" ON storage.objects FOR INSERT WITH CHECK (bucket_id = 'love-memories');

-- Habilitar Row Level Security
ALTER TABLE love_messages ENABLE ROW LEVEL SECURITY;
ALTER TABLE love_memories ENABLE ROW LEVEL SECURITY;
ALTER TABLE daily_phrases ENABLE ROW LEVEL SECURITY;

-- Pol√≠ticas para acceso p√∫blico (opcional, para mayor seguridad configurar autenticaci√≥n)
CREATE POLICY "Allow all operations" ON love_messages FOR ALL USING (true);
CREATE POLICY "Allow all operations" ON love_memories FOR ALL USING (true);
CREATE POLICY "Allow all operations" ON daily_phrases FOR ALL USING (true);

5Ô∏è‚É£ Activar Real-time:
   - Ve a Database > Replication
   - Activa las tablas para real-time

üéâ ¬°Listo! Tu aplicaci√≥n de amor estar√° funcionando.

üí° CARACTER√çSTICAS:
   ‚ú® Calendario interactivo con turnos alternados
   üíå Mensajes de amor en tiempo real
   üì∏ Galer√≠a de recuerdos con im√°genes
   üìÖ Frases del d√≠a por turnos (Nini/Jota)
   üîÑ Sincronizaci√≥n autom√°tica
   üíï Animaciones rom√°nticas
   üì± Responsive design
   üá®üá± Configurado para zona horaria de Chile

üîß PERSONALIZACI√ìN:
   - Cambia la fecha de inicio en: relationshipStart: new Date('2024-10-20')
   - Los turnos alternan cada d√≠a empezando con Nini
   - Colores y efectos se pueden personalizar en CSS

üì± USO:
   - Cada d√≠a corresponde un turno (Nini o Jota)
   - Click en d√≠as del calendario para agregar frases
   - Solo se pueden agregar frases el d√≠a actual
   - Los recuerdos y mensajes se pueden agregar siempre

üõ†Ô∏è ARREGLOS REALIZADOS:
   ‚úÖ Zona horaria configurada para Chile (Calama)
   ‚úÖ Permite agregar frases en el d√≠a actual
   ‚úÖ Validaci√≥n correcta de fechas
   ‚úÖ Formato de fechas chileno (es-CL)

¬°Disfruten su aplicaci√≥n de amor! üíï
                `);
            }
        };

        // ===== INICIALIZAR AL CARGAR LA P√ÅGINA =====
        document.addEventListener('DOMContentLoaded', () => {
            LoveApp.init();
        });

        // ===== CERRAR MODAL CON ESC =====
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                LoveApp.closePhraseModal();
            }
        });

        // ===== CERRAR MODAL CLICKEANDO FUERA =====
        document.getElementById('phraseModal').addEventListener('click', (e) => {
            if (e.target.id === 'phraseModal') {
                LoveApp.closePhraseModal();
            }
        });
    </script>
</body>
</html>
